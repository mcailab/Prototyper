<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slidemake - AI-Powered Presentation Generator</title>
    <meta name="description" content="Slidemake uses AI to generate professional presentations from prompts, translate decks between languages, and create animated slides.">
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Slidemake - AI-Powered Presentation Generator">
    <meta property="og:description" content="Slidemake uses AI to generate professional presentations from prompts, translate decks between languages, and create animated slides.">
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Slidemake - AI-Powered Presentation Generator">
    <meta name="twitter:description" content="Slidemake uses AI to generate professional presentations from prompts, translate decks between languages, and create animated slides.">
    <!-- Favicon - Person chalkboard icon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 640 512'><path fill='%2338bdf8' d='M192 96a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm-8 384V352h16V480c0 17.7 14.3 32 32 32s32-14.3 32-32V192h56 64 16c17.7 0 32-14.3 32-32s-14.3-32-32-32H384V64H576V256H384V192H320v288c0 17.7-14.3 32-32 32s-32-14.3-32-32V288H224V480c0 17.7-14.3 32-32 32s-32-14.3-32-32zM160 192H64c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H384V288H160V192zM640 256V64c0-35.3-28.7-64-64-64H384c-17.7 0-32 14.3-32 32V256H640z'/></svg>">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-gradient-start: #0ea5e9;
            --bg-gradient-end: #6366f1;
            --container-bg: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            --border-color: #e2e8f0;
            --card-bg: #f8f9fa;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --shadow-heavy: rgba(0, 0, 0, 0.15);
            --accent-color: #38bdf8;
            --accent-gradient-start: #38bdf8;
            --accent-gradient-end: #818cf8;
            --upload-border: rgba(56, 189, 248, 0.4);
            --upload-bg: rgba(56, 189, 248, 0.05);
            --upload-hover-bg: rgba(56, 189, 248, 0.1);
            --processing-bar-bg: #e2e8f0;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-gradient-start: #0c4a6e;
                --bg-gradient-end: #312e81;
                --container-bg: #1e293b;
                --text-primary: #f1f5f9;
                --text-secondary: #94a3b8;
                --text-muted: #64748b;
                --border-color: #334155;
                --card-bg: #334155;
                --shadow-color: rgba(0, 0, 0, 0.3);
                --shadow-heavy: rgba(0, 0, 0, 0.5);
                --upload-border: rgba(56, 189, 248, 0.5);
                --upload-bg: rgba(56, 189, 248, 0.08);
                --upload-hover-bg: rgba(56, 189, 248, 0.15);
                --processing-bar-bg: #475569;
            }
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            min-height: 100vh;
            color: var(--text-primary);
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        .container {
            max-width: 1000px;
            width: 100%;
            background: var(--container-bg);
            border-radius: 16px;
            padding: 1rem;
            height: 90vh;
            max-height: 700px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 50px -12px var(--shadow-color);
        }
        .app-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 1rem;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: var(--text-primary);
        }
        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent-gradient-start) 0%, var(--accent-gradient-end) 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            color: #fff;
        }
        .logo span {
            font-size: 1.5rem;
            font-weight: 700;
        }
        .control-panel {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .control-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s;
        }
        .control-btn:hover {
            background: var(--border-color);
        }
        .control-btn.active {
            background: var(--text-primary);
            color: var(--container-bg);
        }
        .demo-area {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            min-height: 0;
        }
        /* Upload Zone */
        .upload-zone {
            width: 100%;
            max-width: 700px;
            padding: 1.5rem;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            transition: all 0.3s;
            position: absolute;
        }
        .upload-zone.drag-over .upload-dropzone {
            border-color: var(--accent-color);
            background: var(--upload-hover-bg);
            transform: scale(1.02);
        }
        .upload-zone.hidden {
            opacity: 0;
            pointer-events: none;
            transform: scale(0.95);
        }
        .upload-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 1.5rem;
        }
        .upload-header-icon {
            font-size: 2rem;
            color: var(--accent-color);
        }
        .upload-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        .upload-dropzone {
            width: 100%;
            height: 280px;
            border: 3px dashed var(--upload-border);
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: var(--upload-bg);
            transition: all 0.3s;
        }
        /* Prompt Zone */
        .prompt-zone {
            width: 100%;
            max-width: 700px;
            padding: 1.5rem;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            position: absolute;
            opacity: 0;
            pointer-events: none;
            transform: scale(0.95);
            transition: all 0.3s;
        }
        .prompt-zone.visible {
            opacity: 1;
            pointer-events: auto;
            transform: scale(1);
        }
        .prompt-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 1.5rem;
        }
        .prompt-icon {
            font-size: 2rem;
            color: var(--accent-color);
        }
        .prompt-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        .prompt-input-container {
            width: 100%;
            margin-bottom: 1.5rem;
        }
        .prompt-input {
            width: 100%;
            min-height: 120px;
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            font-size: 1.1rem;
            font-family: inherit;
            background: var(--container-bg);
            color: var(--text-primary);
            resize: none;
            transition: border-color 0.3s;
        }
        .prompt-input:focus {
            outline: none;
            border-color: var(--accent-color);
        }
        .prompt-input.typing {
            border-color: var(--accent-color);
        }
        .generate-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 14px 32px;
            background: linear-gradient(135deg, var(--accent-gradient-start) 0%, var(--accent-gradient-end) 100%);
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            color: white;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            opacity: 0.5;
        }
        .generate-btn.ready {
            opacity: 1;
        }
        .generate-btn.ready:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(56, 189, 248, 0.4);
        }
        .generate-btn.clicked {
            transform: scale(0.95);
        }
        /* Chat Interface */
        .chat-container {
            width: 100%;
            max-width: 700px;
            max-height: 85%;
            position: absolute;
            display: flex;
            flex-direction: column;
            opacity: 0;
            pointer-events: none;
            transform: scale(0.95);
            transition: all 0.3s;
        }
        .chat-container.visible {
            opacity: 1;
            pointer-events: auto;
            transform: scale(1);
        }
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .chat-bubble {
            max-width: 85%;
            padding: 1rem;
            border-radius: 16px;
            animation: fadeInUp 0.3s ease;
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .chat-bubble.user {
            align-self: flex-end;
            background: linear-gradient(135deg, var(--accent-gradient-start) 0%, var(--accent-gradient-end) 100%);
            color: white;
            border-bottom-right-radius: 4px;
        }
        .chat-bubble.ai {
            align-self: flex-start;
            background: var(--card-bg);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            border-bottom-left-radius: 4px;
        }
        .chat-bubble .bubble-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 0.5rem;
            font-size: 0.85rem;
            opacity: 0.8;
        }
        .chat-bubble.ai .bubble-header {
            color: var(--text-secondary);
        }
        .chat-bubble .bubble-content {
            font-size: 1rem;
            line-height: 1.5;
        }
        .chat-bubble .status-text {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        .chat-bubble .status-text i {
            color: var(--accent-color);
        }
        .chat-bubble .chat-image {
            width: 100%;
            max-width: 450px;
            border-radius: 12px;
            margin-top: 0.75rem;
        }
        .chat-bubble .result-label {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: 0.75rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        .chat-bubble .result-label i {
            color: #10b981;
        }
        .upload-icon {
            font-size: 3rem;
            color: var(--accent-color);
            margin-bottom: 1rem;
        }
        .upload-text {
            font-size: 1.1rem;
            color: var(--text-secondary);
        }
        /* File Preview */
        .file-preview {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s;
        }
        .file-preview.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .file-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            border: 1px solid var(--border-color);
        }
        .file-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            color: #fff;
        }
        .file-info h4 {
            font-size: 1rem;
            margin-bottom: 0.25rem;
            color: var(--text-primary);
        }
        .file-info p {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        .preview-image {
            width: 650px;
            max-width: 95vw;
            max-height: 55vh;
            object-fit: contain;
            border-radius: 12px;
            box-shadow: 0 20px 60px var(--shadow-heavy);
        }
        /* Processing State */
        .processing-overlay {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: all 0.5s;
        }
        .processing-overlay.visible {
            opacity: 1;
        }
        .processing-container {
            position: relative;
            width: 650px;
            max-width: 95vw;
        }
        .processing-image {
            width: 100%;
            max-height: 55vh;
            object-fit: contain;
            border-radius: 12px;
            box-shadow: 0 20px 60px var(--shadow-heavy);
        }
        .processing-bar-container {
            margin-top: 1rem;
            width: 100%;
            max-width: 400px;
        }
        .processing-text {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-primary);
        }
        .processing-bar {
            height: 8px;
            background: var(--processing-bar-bg);
            border-radius: 4px;
            overflow: hidden;
        }
        .processing-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--accent-gradient-start), var(--accent-gradient-end));
            border-radius: 4px;
            transition: width 0.1s linear;
        }
        .processing-status {
            margin-top: 1rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-align: center;
        }
        /* Result State */
        .result-area {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transform: scale(0.95);
            transition: all 0.5s;
        }
        .result-area.visible {
            opacity: 1;
            pointer-events: auto;
            transform: scale(1);
        }
        .result-image {
            width: 650px;
            max-width: 95vw;
            max-height: 55vh;
            object-fit: contain;
            border-radius: 12px;
            box-shadow: 0 20px 60px var(--shadow-heavy);
        }
        .result-badge {
            margin-top: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border-radius: 50px;
            font-weight: 600;
            color: #fff;
        }
        .result-badge i {
            font-size: 1.1rem;
        }
        /* Dragging file indicator */
        .drag-file {
            position: fixed;
            width: 280px;
            height: 220px;
            background: var(--container-bg);
            border-radius: 16px;
            box-shadow: 0 20px 50px var(--shadow-heavy);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            pointer-events: none;
            opacity: 0;
            z-index: 1000;
            transition: opacity 0.2s;
            border: 1px solid var(--border-color);
        }
        .drag-file.visible {
            opacity: 1;
        }
        .drag-file img {
            width: 240px;
            height: 160px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 0.75rem;
        }
        .drag-file span {
            font-size: 0.9rem;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 260px;
            font-weight: 500;
        }

        /* Fullscreen mode */
        body.fullscreen {
            padding: 0;
        }
        body.fullscreen .container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            max-width: 100%;
            max-height: 100%;
            border-radius: 0;
            z-index: 9999;
        }
        body.fullscreen .app-header {
            padding: 1rem 1.5rem;
        }
        body.fullscreen .demo-area {
            height: calc(100vh - 80px);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            body {
                padding: 0;
                align-items: flex-start;
                overflow-y: auto;
            }
            .container {
                border-radius: 0;
                padding: 0;
                height: 100vh;
                max-height: none;
                box-shadow: none;
            }
            .app-header {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                background: var(--container-bg);
                padding: 0.75rem 1rem;
                margin-bottom: 0;
                z-index: 100;
                box-shadow: 0 2px 10px var(--shadow-color);
                border-bottom: 1px solid var(--border-color);
            }
            .logo-icon {
                width: 32px;
                height: 32px;
                font-size: 1rem;
            }
            .logo span {
                font-size: 1.2rem;
            }
            .control-btn span {
                display: none;
            }
            .control-btn {
                padding: 8px 10px;
            }
            .demo-area {
                margin-top: 60px;
                height: calc(100vh - 60px);
                padding: 1rem;
            }
            .upload-zone {
                max-width: 100%;
                padding: 1rem;
            }
            .upload-header {
                margin-bottom: 1rem;
            }
            .upload-header-icon {
                font-size: 1.5rem;
            }
            .upload-title {
                font-size: 1.2rem;
            }
            .upload-dropzone {
                height: 200px;
            }
            .upload-icon {
                font-size: 2.5rem;
                margin-bottom: 0.75rem;
            }
            .upload-text {
                font-size: 0.9rem;
            }
            .preview-image,
            .processing-container,
            .result-image {
                width: 100%;
                max-width: 100%;
            }
            .prompt-zone {
                padding: 1.5rem;
                max-width: 100%;
            }
            .prompt-icon {
                font-size: 1.5rem;
            }
            .prompt-title {
                font-size: 1.2rem;
            }
            .prompt-input {
                min-height: 100px;
                font-size: 1rem;
            }
            .generate-btn {
                padding: 12px 24px;
                font-size: 1rem;
            }
            .chat-container {
                max-width: 100%;
                max-height: 90%;
            }
            .chat-bubble {
                max-width: 90%;
                padding: 0.75rem;
            }
            .chat-bubble .chat-image {
                max-width: 100%;
            }
        }

        /* Slide Preview Styles */
        .slide-preview {
            width: 650px;
            max-width: 95vw;
            aspect-ratio: 16/9;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px var(--shadow-heavy);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }
        .slide-header {
            background: linear-gradient(135deg, var(--accent-gradient-start) 0%, var(--accent-gradient-end) 100%);
            padding: 1.5rem 2rem;
            color: white;
        }
        .slide-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        .slide-header p {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        .slide-body {
            flex: 1;
            padding: 1.5rem 2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            background: #fafafa;
        }
        .slide-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 0.75rem 1rem;
            background: white;
            border-radius: 8px;
            border-left: 4px solid var(--accent-color);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .slide-item i {
            color: var(--accent-color);
            font-size: 1.1rem;
            width: 24px;
            text-align: center;
        }
        .slide-item span {
            font-size: 0.95rem;
            color: #333;
        }
        .slide-footer {
            padding: 0.75rem 2rem;
            background: #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: #666;
        }
        .slide-page {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        /* Chinese slide variant */
        .slide-preview.chinese .slide-header {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        .slide-preview.chinese .slide-item {
            border-left-color: #ef4444;
        }
        .slide-preview.chinese .slide-item i {
            color: #ef4444;
        }
        /* Animated slide variant */
        .slide-preview.animated .slide-header {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            position: relative;
            overflow: hidden;
        }
        .slide-preview.animated .slide-header::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent 40%, rgba(255,255,255,0.1) 50%, transparent 60%);
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        .slide-preview.animated .slide-item {
            border-left-color: #8b5cf6;
            animation: slideIn 0.5s ease forwards;
            opacity: 0;
        }
        .slide-preview.animated .slide-item:nth-child(1) { animation-delay: 0.1s; }
        .slide-preview.animated .slide-item:nth-child(2) { animation-delay: 0.2s; }
        .slide-preview.animated .slide-item:nth-child(3) { animation-delay: 0.3s; }
        .slide-preview.animated .slide-item:nth-child(4) { animation-delay: 0.4s; }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .slide-preview.animated .slide-item i {
            color: #8b5cf6;
        }
        .animation-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255,255,255,0.2);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        /* Drag file slide preview */
        .drag-file .slide-mini {
            width: 240px;
            height: 135px;
            background: white;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid #ddd;
        }
        .drag-file .slide-mini-header {
            background: linear-gradient(135deg, var(--accent-gradient-start) 0%, var(--accent-gradient-end) 100%);
            padding: 0.5rem 0.75rem;
            color: white;
            font-size: 0.7rem;
            font-weight: 600;
        }
        .drag-file .slide-mini-body {
            flex: 1;
            padding: 0.5rem;
            display: flex;
            flex-direction: column;
            gap: 4px;
            background: #fafafa;
        }
        .drag-file .slide-mini-item {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 3px 6px;
            background: white;
            border-radius: 4px;
            font-size: 0.6rem;
            color: #333;
            border-left: 2px solid var(--accent-color);
        }
        .drag-file .slide-mini-item i {
            font-size: 0.55rem;
            color: var(--accent-color);
        }
        @media (max-width: 768px) {
            .slide-preview {
                width: 100%;
            }
            .slide-header {
                padding: 1rem 1.25rem;
            }
            .slide-header h2 {
                font-size: 1.1rem;
            }
            .slide-body {
                padding: 1rem 1.25rem;
            }
            .slide-item {
                padding: 0.5rem 0.75rem;
            }
            .slide-item span {
                font-size: 0.85rem;
            }
        }

        /* Ending Scene */
        .ending-scene {
            position: absolute;
            inset: 0;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s, visibility 0.5s;
            z-index: 50;
        }
        .ending-scene.visible {
            opacity: 1;
            visibility: visible;
        }
        .ending-video {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        /* Slide Viewer Overlay */
        .slide-viewer-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        .slide-viewer-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        .slide-viewer-header {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            color: white;
        }
        .slide-viewer-title {
            font-size: 1.2rem;
            font-weight: 600;
        }
        .slide-viewer-close {
            background: rgba(255,255,255,0.1);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: background 0.2s;
        }
        .slide-viewer-close:hover {
            background: rgba(255,255,255,0.2);
        }
        .slide-viewer-content {
            width: 90%;
            max-width: 900px;
            aspect-ratio: 16/9;
        }
        .slide-viewer-content .slide-preview {
            width: 100%;
            height: 100%;
            aspect-ratio: auto;
        }
        .slide-viewer-nav {
            position: absolute;
            bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        .slide-nav-btn {
            background: rgba(255,255,255,0.15);
            border: none;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.2s;
        }
        .slide-nav-btn:hover:not(:disabled) {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
        }
        .slide-nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        .slide-counter {
            color: white;
            font-size: 1rem;
            font-weight: 500;
            min-width: 80px;
            text-align: center;
        }
        .slide-dots {
            display: flex;
            gap: 8px;
        }
        .slide-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            cursor: pointer;
            transition: all 0.2s;
        }
        .slide-dot.active {
            background: white;
            transform: scale(1.2);
        }
        .slide-dot:hover {
            background: rgba(255,255,255,0.6);
        }
        /* Clickable slide in chat */
        .chat-bubble .slide-preview {
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .chat-bubble .slide-preview:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 30px rgba(0,0,0,0.2);
        }
        .click-hint {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: 0.5rem;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        .click-hint i {
            color: var(--accent-color);
        }

        /* ===== CREATIVE SLIDE LAYOUTS ===== */

        /* Cover Slide - Hero with animated particles */
        .slide-preview.layout-cover {
            position: relative;
            overflow: hidden;
        }
        .slide-preview.layout-cover .slide-header {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            position: relative;
            z-index: 1;
        }
        .slide-preview.layout-cover .slide-header h2 {
            font-size: 2rem;
            margin-bottom: 0.75rem;
        }
        .slide-preview.layout-cover .slide-header p {
            font-size: 1.1rem;
        }
        .slide-preview.layout-cover .slide-body {
            display: none;
        }
        .slide-preview.layout-cover .cover-stats {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 1.5rem;
        }
        .slide-preview.layout-cover .cover-stat {
            text-align: center;
        }
        .slide-preview.layout-cover .cover-stat-value {
            font-size: 2rem;
            font-weight: 700;
            display: block;
        }
        .slide-preview.layout-cover .cover-stat-label {
            font-size: 0.8rem;
            opacity: 0.9;
        }
        /* Animated particles background */
        .slide-preview.layout-cover::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background:
                radial-gradient(circle at 20% 30%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255,255,255,0.08) 0%, transparent 40%),
                radial-gradient(circle at 50% 50%, rgba(255,255,255,0.05) 0%, transparent 60%);
            animation: coverPulse 4s ease-in-out infinite;
        }
        @keyframes coverPulse {
            0%, 100% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }
        /* Animated cover stats */
        .slide-preview.layout-cover.animated .cover-stat-value {
            animation: countUp 1.5s ease-out forwards;
        }
        @keyframes countUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .slide-preview.layout-cover.animated .cover-stat:nth-child(1) .cover-stat-value { animation-delay: 0.2s; }
        .slide-preview.layout-cover.animated .cover-stat:nth-child(2) .cover-stat-value { animation-delay: 0.4s; }
        .slide-preview.layout-cover.animated .cover-stat:nth-child(3) .cover-stat-value { animation-delay: 0.6s; }

        /* Bar Chart Slide */
        .slide-preview.layout-bar .slide-body {
            flex-direction: row;
            align-items: flex-end;
            justify-content: space-around;
            padding: 1rem 2rem 1.5rem;
            gap: 0.5rem;
        }
        .bar-chart-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            max-width: 80px;
        }
        .bar-wrapper {
            width: 100%;
            height: 120px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            margin-bottom: 0.5rem;
        }
        .bar {
            width: 70%;
            background: linear-gradient(180deg, var(--accent-gradient-start) 0%, var(--accent-gradient-end) 100%);
            border-radius: 6px 6px 0 0;
            position: relative;
            transition: height 0.3s ease;
        }
        .bar-value {
            position: absolute;
            top: -24px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--accent-color);
            white-space: nowrap;
        }
        .bar-label {
            font-size: 0.7rem;
            color: #666;
            text-align: center;
            line-height: 1.2;
        }
        /* Animated bar growth */
        .slide-preview.layout-bar.animated .bar {
            animation: barGrow 1s ease-out forwards;
            height: 0 !important;
        }
        .slide-preview.layout-bar.animated .bar-chart-item:nth-child(1) .bar { animation-delay: 0.1s; }
        .slide-preview.layout-bar.animated .bar-chart-item:nth-child(2) .bar { animation-delay: 0.2s; }
        .slide-preview.layout-bar.animated .bar-chart-item:nth-child(3) .bar { animation-delay: 0.3s; }
        .slide-preview.layout-bar.animated .bar-chart-item:nth-child(4) .bar { animation-delay: 0.4s; }
        @keyframes barGrow {
            to { height: var(--bar-height) !important; }
        }
        .slide-preview.layout-bar.animated .bar-value {
            opacity: 0;
            animation: fadeInUp 0.3s ease forwards;
        }
        .slide-preview.layout-bar.animated .bar-chart-item:nth-child(1) .bar-value { animation-delay: 1.1s; }
        .slide-preview.layout-bar.animated .bar-chart-item:nth-child(2) .bar-value { animation-delay: 1.2s; }
        .slide-preview.layout-bar.animated .bar-chart-item:nth-child(3) .bar-value { animation-delay: 1.3s; }
        .slide-preview.layout-bar.animated .bar-chart-item:nth-child(4) .bar-value { animation-delay: 1.4s; }

        /* Timeline Slide */
        .slide-preview.layout-timeline .slide-body {
            padding: 1rem 1.5rem;
            position: relative;
        }
        .timeline-container {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            position: relative;
            padding-left: 2rem;
        }
        .timeline-container::before {
            content: '';
            position: absolute;
            left: 8px;
            top: 10px;
            bottom: 10px;
            width: 3px;
            background: linear-gradient(180deg, var(--accent-gradient-start) 0%, var(--accent-gradient-end) 100%);
            border-radius: 2px;
        }
        .timeline-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
        }
        .timeline-node {
            position: absolute;
            left: -2rem;
            width: 20px;
            height: 20px;
            background: white;
            border: 3px solid var(--accent-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1;
        }
        .timeline-node i {
            font-size: 0.6rem;
            color: var(--accent-color);
        }
        .timeline-content {
            flex: 1;
            padding: 0.6rem 1rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border-left: 3px solid var(--accent-color);
        }
        .timeline-content span {
            font-size: 0.85rem;
            color: #333;
        }
        /* Animated timeline */
        .slide-preview.layout-timeline.animated .timeline-item {
            opacity: 0;
            transform: translateX(-20px);
            animation: timelineSlide 0.5s ease forwards;
        }
        .slide-preview.layout-timeline.animated .timeline-item:nth-child(1) { animation-delay: 0.2s; }
        .slide-preview.layout-timeline.animated .timeline-item:nth-child(2) { animation-delay: 0.4s; }
        .slide-preview.layout-timeline.animated .timeline-item:nth-child(3) { animation-delay: 0.6s; }
        .slide-preview.layout-timeline.animated .timeline-item:nth-child(4) { animation-delay: 0.8s; }
        @keyframes timelineSlide {
            to { opacity: 1; transform: translateX(0); }
        }
        .slide-preview.layout-timeline.animated .timeline-node {
            animation: nodePop 0.3s ease forwards;
            transform: scale(0);
        }
        .slide-preview.layout-timeline.animated .timeline-item:nth-child(1) .timeline-node { animation-delay: 0.3s; }
        .slide-preview.layout-timeline.animated .timeline-item:nth-child(2) .timeline-node { animation-delay: 0.5s; }
        .slide-preview.layout-timeline.animated .timeline-item:nth-child(3) .timeline-node { animation-delay: 0.7s; }
        .slide-preview.layout-timeline.animated .timeline-item:nth-child(4) .timeline-node { animation-delay: 0.9s; }
        @keyframes nodePop {
            to { transform: scale(1); }
        }

        /* Pie Chart Slide */
        .slide-preview.layout-pie .slide-body {
            flex-direction: row;
            padding: 1rem 1.5rem;
            gap: 1.5rem;
        }
        .pie-chart-container {
            flex: 0 0 140px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .pie-chart {
            width: 130px;
            height: 130px;
            border-radius: 50%;
            position: relative;
            background: conic-gradient(
                #38bdf8 0deg 126deg,
                #818cf8 126deg 216deg,
                #f472b6 216deg 288deg,
                #34d399 288deg 360deg
            );
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        .pie-chart::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            background: #fafafa;
            border-radius: 50%;
        }
        .pie-legend {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            justify-content: center;
        }
        .pie-legend-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 0.75rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        }
        .pie-legend-color {
            width: 14px;
            height: 14px;
            border-radius: 4px;
            flex-shrink: 0;
        }
        .pie-legend-text {
            font-size: 0.8rem;
            color: #333;
            flex: 1;
        }
        .pie-legend-value {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--accent-color);
        }
        /* Animated pie */
        .slide-preview.layout-pie.animated .pie-chart {
            animation: pieRotate 1.2s ease-out forwards;
            transform: rotate(-90deg);
        }
        @keyframes pieRotate {
            from { transform: rotate(-90deg); clip-path: polygon(50% 50%, 50% 0%, 50% 0%); }
            to { transform: rotate(-90deg); clip-path: polygon(50% 50%, 50% 0%, 100% 0%, 100% 100%, 0% 100%, 0% 0%, 50% 0%); }
        }
        .slide-preview.layout-pie.animated .pie-legend-item {
            opacity: 0;
            transform: translateX(20px);
            animation: legendSlide 0.4s ease forwards;
        }
        .slide-preview.layout-pie.animated .pie-legend-item:nth-child(1) { animation-delay: 0.3s; }
        .slide-preview.layout-pie.animated .pie-legend-item:nth-child(2) { animation-delay: 0.5s; }
        .slide-preview.layout-pie.animated .pie-legend-item:nth-child(3) { animation-delay: 0.7s; }
        .slide-preview.layout-pie.animated .pie-legend-item:nth-child(4) { animation-delay: 0.9s; }
        @keyframes legendSlide {
            to { opacity: 1; transform: translateX(0); }
        }

        /* Metrics Cards Slide */
        .slide-preview.layout-metrics .slide-body {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            padding: 1rem 1.5rem;
        }
        .metric-card {
            background: white;
            border-radius: 12px;
            padding: 1rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            border-top: 3px solid var(--accent-color);
        }
        .metric-card:nth-child(1) { border-top-color: #38bdf8; }
        .metric-card:nth-child(2) { border-top-color: #818cf8; }
        .metric-card:nth-child(3) { border-top-color: #f472b6; }
        .metric-card:nth-child(4) { border-top-color: #34d399; }
        .metric-icon {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 0.5rem;
            font-size: 1rem;
            color: white;
        }
        .metric-card:nth-child(1) .metric-icon { background: linear-gradient(135deg, #38bdf8, #0ea5e9); }
        .metric-card:nth-child(2) .metric-icon { background: linear-gradient(135deg, #818cf8, #6366f1); }
        .metric-card:nth-child(3) .metric-icon { background: linear-gradient(135deg, #f472b6, #ec4899); }
        .metric-card:nth-child(4) .metric-icon { background: linear-gradient(135deg, #34d399, #10b981); }
        .metric-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.25rem;
        }
        .metric-label {
            font-size: 0.75rem;
            color: #64748b;
            line-height: 1.3;
        }
        /* Animated metrics */
        .slide-preview.layout-metrics.animated .metric-card {
            opacity: 0;
            transform: scale(0.8) translateY(20px);
            animation: metricPop 0.5s ease forwards;
        }
        .slide-preview.layout-metrics.animated .metric-card:nth-child(1) { animation-delay: 0.1s; }
        .slide-preview.layout-metrics.animated .metric-card:nth-child(2) { animation-delay: 0.2s; }
        .slide-preview.layout-metrics.animated .metric-card:nth-child(3) { animation-delay: 0.3s; }
        .slide-preview.layout-metrics.animated .metric-card:nth-child(4) { animation-delay: 0.4s; }
        @keyframes metricPop {
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        .slide-preview.layout-metrics.animated .metric-value {
            animation: valueGlow 1.5s ease-in-out infinite;
            animation-delay: 1s;
        }
        @keyframes valueGlow {
            0%, 100% { text-shadow: none; }
            50% { text-shadow: 0 0 10px rgba(56, 189, 248, 0.5); }
        }

        /* Chinese variants for creative layouts */
        .slide-preview.layout-bar.chinese .bar {
            background: linear-gradient(180deg, #ef4444 0%, #dc2626 100%);
        }
        .slide-preview.layout-bar.chinese .bar-value { color: #ef4444; }
        .slide-preview.layout-timeline.chinese .timeline-container::before {
            background: linear-gradient(180deg, #ef4444 0%, #dc2626 100%);
        }
        .slide-preview.layout-timeline.chinese .timeline-node { border-color: #ef4444; }
        .slide-preview.layout-timeline.chinese .timeline-node i { color: #ef4444; }
        .slide-preview.layout-timeline.chinese .timeline-content { border-left-color: #ef4444; }
        .slide-preview.layout-pie.chinese .pie-chart {
            background: conic-gradient(
                #ef4444 0deg 126deg,
                #f97316 126deg 216deg,
                #fbbf24 216deg 288deg,
                #84cc16 288deg 360deg
            );
        }
        .slide-preview.layout-metrics.chinese .metric-card:nth-child(1) { border-top-color: #ef4444; }
        .slide-preview.layout-metrics.chinese .metric-card:nth-child(2) { border-top-color: #f97316; }
        .slide-preview.layout-metrics.chinese .metric-card:nth-child(3) { border-top-color: #fbbf24; }
        .slide-preview.layout-metrics.chinese .metric-card:nth-child(4) { border-top-color: #84cc16; }
        .slide-preview.layout-metrics.chinese .metric-card:nth-child(1) .metric-icon { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .slide-preview.layout-metrics.chinese .metric-card:nth-child(2) .metric-icon { background: linear-gradient(135deg, #f97316, #ea580c); }
        .slide-preview.layout-metrics.chinese .metric-card:nth-child(3) .metric-icon { background: linear-gradient(135deg, #fbbf24, #f59e0b); }
        .slide-preview.layout-metrics.chinese .metric-card:nth-child(4) .metric-icon { background: linear-gradient(135deg, #84cc16, #65a30d); }

        @media (max-width: 768px) {
            .slide-viewer-content {
                width: 95%;
            }
            .slide-nav-btn {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
            .slide-viewer-header {
                padding: 0.75rem 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="app-header">
            <a href="index.html" class="logo">
                <div class="logo-icon">
                    <i class="fas fa-person-chalkboard"></i>
                </div>
                <span>Slidemake</span>
            </a>
            <div class="control-panel">
                <button id="homeBtn" class="control-btn" title="Home">
                    <i class="fas fa-home"></i>
                </button>
                <button id="fullscreenBtn" class="control-btn" title="Fullscreen">
                    <i class="fas fa-expand"></i>
                </button>
                <button id="playPauseBtn" class="control-btn active" title="Pause">
                    <i class="fas fa-pause"></i>
                </button>
            </div>
        </header>

        <div class="demo-area">
            <!-- Upload Zone (for deck translation) -->
            <div class="upload-zone" id="uploadZone">
                <div class="upload-header">
                    <i class="fas fa-language upload-header-icon" id="uploadHeaderIcon"></i>
                    <p class="upload-title" id="uploadTitle">Deck Translation</p>
                </div>
                <div class="upload-dropzone">
                    <i class="fas fa-cloud-arrow-up upload-icon"></i>
                    <p class="upload-text" id="uploadText">Drag & drop your English deck here</p>
                </div>
            </div>

            <!-- Prompt Zone (for prompt to deck) -->
            <div class="prompt-zone" id="promptZone">
                <div class="prompt-header">
                    <i class="fas fa-person-chalkboard prompt-icon"></i>
                    <p class="prompt-title" id="promptZoneTitle">Prompt to Deck</p>
                </div>
                <div class="prompt-input-container">
                    <textarea class="prompt-input" id="promptInput" placeholder="Describe the presentation you want to create..." readonly></textarea>
                </div>
                <button class="generate-btn" id="generateBtn">
                    <i class="fas fa-paper-plane"></i>
                    <span>Send</span>
                </button>
            </div>

            <!-- Chat Interface -->
            <div class="chat-container" id="chatContainer">
                <div class="chat-messages" id="chatMessages">
                </div>
            </div>

            <!-- Processing State -->
            <div class="processing-overlay" id="processingOverlay">
                <div class="processing-container">
                    <div class="slide-preview" id="processingSlide">
                        <div class="slide-header">
                            <h2>Q3 Sales Report</h2>
                            <p>Quarterly Performance Overview</p>
                        </div>
                        <div class="slide-body">
                            <div class="slide-item"><i class="fas fa-chart-line"></i> <span>Revenue Growth: +25%</span></div>
                            <div class="slide-item"><i class="fas fa-users"></i> <span>New Customers: 1,200</span></div>
                            <div class="slide-item"><i class="fas fa-globe"></i> <span>Market Expansion to APAC</span></div>
                            <div class="slide-item"><i class="fas fa-bullseye"></i> <span>Q4 Targets & Strategy</span></div>
                        </div>
                        <div class="slide-footer">
                            <span>Slidemake AI</span>
                            <div class="slide-page"><i class="fas fa-clone"></i> 1 / 5</div>
                        </div>
                    </div>
                </div>
                <div class="processing-bar-container">
                    <div class="processing-text">
                        <span id="processingLabel">Translating deck...</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="processing-bar">
                        <div class="processing-fill" id="progressFill"></div>
                    </div>
                    <p class="processing-status" id="processingStatus">Analyzing content...</p>
                </div>
            </div>

            <!-- Result Area -->
            <div class="result-area" id="resultArea">
                <div class="slide-preview chinese" id="resultSlide">
                    <div class="slide-header">
                        <h2></h2>
                        <p></p>
                    </div>
                    <div class="slide-body">
                        <div class="slide-item"><i class="fas fa-chart-line"></i> <span>+25%</span></div>
                        <div class="slide-item"><i class="fas fa-users"></i> <span>1,200 </span></div>
                        <div class="slide-item"><i class="fas fa-globe"></i> <span></span></div>
                        <div class="slide-item"><i class="fas fa-bullseye"></i> <span></span></div>
                    </div>
                    <div class="slide-footer">
                        <span>Slidemake AI</span>
                        <div class="slide-page"><i class="fas fa-clone"></i> 1 / 5</div>
                    </div>
                </div>
                <div class="result-badge" id="resultBadge">
                    <i class="fas fa-check"></i>
                    <span id="resultBadgeText">Deck Complete!</span>
                </div>
            </div>

            <!-- Ending Scene -->
            <div class="ending-scene" id="endingScene">
                <video class="ending-video" id="endingVideo" muted playsinline>
                    <source src="../Ending.mp4" type="video/mp4">
                </video>
            </div>
        </div>

        <!-- Dragging file indicator -->
        <div class="drag-file" id="dragFile">
            <div class="slide-mini" id="dragSlidePreview">
                <div class="slide-mini-header">Q3 Sales Report</div>
                <div class="slide-mini-body">
                    <div class="slide-mini-item"><i class="fas fa-chart-line"></i> Revenue Growth: +25%</div>
                    <div class="slide-mini-item"><i class="fas fa-users"></i> New Customers: 1,200</div>
                    <div class="slide-mini-item"><i class="fas fa-globe"></i> Market Expansion</div>
                </div>
            </div>
            <span id="dragFileName">pitch-deck-en.pptx</span>
        </div>

        <!-- Slide Viewer Overlay -->
        <div class="slide-viewer-overlay" id="slideViewerOverlay">
            <div class="slide-viewer-header">
                <span class="slide-viewer-title" id="slideViewerTitle">AI Startup Pitch Deck</span>
                <button class="slide-viewer-close" id="slideViewerClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="slide-viewer-content">
                <div class="slide-preview" id="slideViewerSlide"></div>
            </div>
            <div class="slide-viewer-nav">
                <button class="slide-nav-btn" id="slidePrevBtn">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <div class="slide-dots" id="slideDots"></div>
                <button class="slide-nav-btn" id="slideNextBtn">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Demo Animation Script
        const uploadZone = document.getElementById('uploadZone');
        const uploadHeaderIcon = document.getElementById('uploadHeaderIcon');
        const uploadTitle = document.getElementById('uploadTitle');
        const uploadText = document.getElementById('uploadText');
        const processingOverlay = document.getElementById('processingOverlay');
        const resultArea = document.getElementById('resultArea');
        const progressFill = document.getElementById('progressFill');
        const progressPercent = document.getElementById('progressPercent');
        const processingStatus = document.getElementById('processingStatus');
        const processingLabel = document.getElementById('processingLabel');
        const processingImage = document.getElementById('processingImage');
        const resultImage = document.getElementById('resultImage');
        const resultBadgeText = document.getElementById('resultBadgeText');
        const dragFile = document.getElementById('dragFile');
        const dragFileImage = document.getElementById('dragFileImage');
        const dragFileName = document.getElementById('dragFileName');
        const homeBtn = document.getElementById('homeBtn');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const endingScene = document.getElementById('endingScene');
        const endingVideo = document.getElementById('endingVideo');

        // Prompt zone elements
        const promptZone = document.getElementById('promptZone');
        const promptZoneTitle = document.getElementById('promptZoneTitle');
        const promptInput = document.getElementById('promptInput');
        const generateBtn = document.getElementById('generateBtn');

        // Chat elements
        const chatContainer = document.getElementById('chatContainer');
        const chatMessages = document.getElementById('chatMessages');

        // Check URL params for autoplay sequence
        const urlParams = new URLSearchParams(window.location.search);
        const autoplay = urlParams.get('autoplay') === '1';

        // Home button
        homeBtn.addEventListener('click', () => {
            window.location.href = '../';
        });

        // Demo samples - three types with slide content
        // All use consistent "Full Auto Driving Market 2026" research theme with 5 slides
        // Each slide has a unique layout for visual variety
        const deckTheme = {
            title: 'Full Auto Driving 2026',
            subtitle: 'Global Market Research Report',
            slides: [
                {
                    layout: 'cover',
                    title: 'Full Auto Driving 2026',
                    subtitle: 'Global Market Research Report',
                    coverStats: [
                        { value: '$45B', label: 'Market Size' },
                        { value: '38%', label: 'CAGR' },
                        { value: '15+', label: 'Key Players' }
                    ]
                },
                {
                    layout: 'bar',
                    title: 'Market Drivers',
                    subtitle: 'Growth Factor Impact Analysis',
                    barData: [
                        { value: 95, label: 'AI Tech', displayValue: '95%' },
                        { value: 80, label: 'Regulations', displayValue: '80%' },
                        { value: 70, label: 'Cost Drop', displayValue: '-60%' },
                        { value: 65, label: 'Smart City', displayValue: '65%' }
                    ]
                },
                {
                    layout: 'timeline',
                    title: 'Technology Roadmap',
                    subtitle: 'Core Enablers & Milestones',
                    timelineItems: [
                        { icon: 'fa-brain', text: 'Neural Networks for Perception & Planning' },
                        { icon: 'fa-satellite', text: 'HD Mapping & V2X Communication' },
                        { icon: 'fa-eye', text: 'Multi-Sensor Fusion (Camera, Radar, LiDAR)' },
                        { icon: 'fa-cloud', text: 'Edge Computing & OTA Updates' }
                    ]
                },
                {
                    layout: 'pie',
                    title: 'Market Share 2026',
                    subtitle: 'Competitive Landscape',
                    pieData: [
                        { color: '#38bdf8', label: 'Tesla FSD', value: '35%' },
                        { color: '#818cf8', label: 'Waymo', value: '25%' },
                        { color: '#f472b6', label: 'Cruise', value: '20%' },
                        { color: '#34d399', label: 'Others', value: '20%' }
                    ]
                },
                {
                    layout: 'metrics',
                    title: 'Investment Outlook',
                    subtitle: 'Key Opportunities & Metrics',
                    metrics: [
                        { icon: 'fa-taxi', value: '$12B', label: 'Robotaxi Market 2026' },
                        { icon: 'fa-truck', value: '35%', label: 'Logistics Cost Savings' },
                        { icon: 'fa-chart-line', value: '2M+', label: 'Tesla FSD Vehicles' },
                        { icon: 'fa-globe', value: '15+', label: 'Cities with Robotaxis' }
                    ]
                }
            ],
            // Chinese translated version with same layouts
            slidesChinese: [
                {
                    layout: 'cover',
                    title: ' 2026',
                    subtitle: '',
                    coverStats: [
                        { value: '$450', label: '' },
                        { value: '38%', label: '' },
                        { value: '15+', label: '' }
                    ]
                },
                {
                    layout: 'bar',
                    title: '',
                    subtitle: '',
                    barData: [
                        { value: 95, label: 'AI', displayValue: '95%' },
                        { value: 80, label: '', displayValue: '80%' },
                        { value: 70, label: '', displayValue: '-60%' },
                        { value: 65, label: '', displayValue: '65%' }
                    ]
                },
                {
                    layout: 'timeline',
                    title: '',
                    subtitle: '',
                    timelineItems: [
                        { icon: 'fa-brain', text: '' },
                        { icon: 'fa-satellite', text: 'V2X' },
                        { icon: 'fa-eye', text: '' },
                        { icon: 'fa-cloud', text: 'OTA' }
                    ]
                },
                {
                    layout: 'pie',
                    title: '2026',
                    subtitle: '',
                    pieData: [
                        { color: '#ef4444', label: 'Tesla FSD', value: '35%' },
                        { color: '#f97316', label: 'Waymo', value: '25%' },
                        { color: '#fbbf24', label: 'Cruise', value: '20%' },
                        { color: '#84cc16', label: '', value: '20%' }
                    ]
                },
                {
                    layout: 'metrics',
                    title: '',
                    subtitle: '',
                    metrics: [
                        { icon: 'fa-taxi', value: '$120', label: '' },
                        { icon: 'fa-truck', value: '35%', label: '' },
                        { icon: 'fa-chart-line', value: '200+', label: 'Tesla FSD' },
                        { icon: 'fa-globe', value: '15+', label: '' }
                    ]
                }
            ]
        };

        const samples = [
            {
                type: 'prompt',
                title: 'Prompt to Deck',
                prompt: "Create a market research presentation on Full Autonomous Driving market outlook for 2026",
                resultText: "Here's your market research on Full Auto Driving 2026:",
                badge: 'Research Complete!',
                slideClass: '',
                slideContent: deckTheme.slides[0],
                allSlides: deckTheme.slides
            },
            {
                type: 'upload',
                title: 'Deck Translation',
                fileName: 'auto-driving-2026-en.pptx',
                badge: 'Translation Complete!',
                inputSlide: deckTheme.slides[0],
                resultSlide: deckTheme.slidesChinese[0],
                allInputSlides: deckTheme.slides,
                allResultSlides: deckTheme.slidesChinese
            },
            {
                type: 'animate',
                title: 'Animate Deck',
                fileName: 'auto-driving-2026.pptx',
                badge: 'Animation Complete!',
                inputSlide: deckTheme.slides[0],
                resultSlide: deckTheme.slides[0],
                allInputSlides: deckTheme.slides,
                allResultSlides: deckTheme.slides
            }
        ];

        let currentSampleIndex = 0;
        const RESULT_DISPLAY_TIME = 6000;
        const ENDING_SCENE_DURATION = 5000;
        let isPaused = false;
        let loopCount = 0;

        // Status messages for different operations
        const translationStatusMessages = [
            'Analyzing deck structure...',
            'Extracting text content...',
            'Translating to Chinese...',
            'Preserving formatting...',
            'Applying translations...',
            'Finalizing deck...'
        ];

        const promptStatusMessages = [
            'Understanding your requirements...',
            'Generating slide structure...',
            'Creating visual layouts...',
            'Adding content...',
            'Applying design theme...',
            'Finalizing presentation...'
        ];

        const animatedStatusMessages = [
            'Understanding your requirements...',
            'Generating slide structure...',
            'Creating animations...',
            'Adding motion effects...',
            'Syncing transitions...',
            'Rendering animated deck...'
        ];

        let currentStatusMessages = promptStatusMessages;
        let animationRunning = false;
        let currentPhase = 'idle';

        // Slide elements
        const processingSlide = document.getElementById('processingSlide');
        const resultSlide = document.getElementById('resultSlide');
        const dragSlidePreview = document.getElementById('dragSlidePreview');

        // Helper function to render slide content based on layout type
        function renderSlide(slideElement, content, slideClass = '') {
            const layout = content.layout || 'default';
            const isAnimated = slideClass.includes('animated');
            const layoutClass = layout !== 'default' ? `layout-${layout}` : '';
            slideElement.className = `slide-preview ${layoutClass} ${slideClass}`.trim();

            let bodyContent = '';
            let headerExtra = isAnimated ? '<div class="animation-badge"><i class="fas fa-play"></i> Animated</div>' : '';

            switch (layout) {
                case 'cover':
                    bodyContent = `
                        <div class="cover-stats">
                            ${content.coverStats.map(stat => `
                                <div class="cover-stat">
                                    <span class="cover-stat-value">${stat.value}</span>
                                    <span class="cover-stat-label">${stat.label}</span>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    // For cover, stats go in header area
                    slideElement.innerHTML = `
                        <div class="slide-header">
                            <h2>${content.title}</h2>
                            <p>${content.subtitle}</p>
                            ${bodyContent}
                            ${headerExtra}
                        </div>
                        <div class="slide-body"></div>
                        <div class="slide-footer">
                            <span>Slidemake AI</span>
                            <div class="slide-page"><i class="fas fa-clone"></i> 1 / 5</div>
                        </div>
                    `;
                    return;

                case 'bar':
                    const maxBarHeight = 100;
                    bodyContent = content.barData.map(bar => `
                        <div class="bar-chart-item">
                            <div class="bar-wrapper">
                                <div class="bar" style="height: ${bar.value}px; --bar-height: ${bar.value}px;">
                                    <span class="bar-value">${bar.displayValue}</span>
                                </div>
                            </div>
                            <span class="bar-label">${bar.label}</span>
                        </div>
                    `).join('');
                    break;

                case 'timeline':
                    bodyContent = `
                        <div class="timeline-container">
                            ${content.timelineItems.map(item => `
                                <div class="timeline-item">
                                    <div class="timeline-node"><i class="fas ${item.icon}"></i></div>
                                    <div class="timeline-content"><span>${item.text}</span></div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    break;

                case 'pie':
                    bodyContent = `
                        <div class="pie-chart-container">
                            <div class="pie-chart"></div>
                        </div>
                        <div class="pie-legend">
                            ${content.pieData.map(item => `
                                <div class="pie-legend-item">
                                    <div class="pie-legend-color" style="background: ${item.color};"></div>
                                    <span class="pie-legend-text">${item.label}</span>
                                    <span class="pie-legend-value">${item.value}</span>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    break;

                case 'metrics':
                    bodyContent = content.metrics.map(metric => `
                        <div class="metric-card">
                            <div class="metric-icon"><i class="fas ${metric.icon}"></i></div>
                            <span class="metric-value">${metric.value}</span>
                            <span class="metric-label">${metric.label}</span>
                        </div>
                    `).join('');
                    break;

                default:
                    // Fallback for items-based slides
                    if (content.items) {
                        bodyContent = content.items.map(item => `
                            <div class="slide-item">
                                <i class="fas ${item.icon}"></i>
                                <span>${item.text}</span>
                            </div>
                        `).join('');
                    }
            }

            slideElement.innerHTML = `
                <div class="slide-header">
                    <h2>${content.title}</h2>
                    <p>${content.subtitle}</p>
                    ${headerExtra}
                </div>
                <div class="slide-body">
                    ${bodyContent}
                </div>
                <div class="slide-footer">
                    <span>Slidemake AI</span>
                    <div class="slide-page"><i class="fas fa-clone"></i> 1 / 5</div>
                </div>
            `;
        }

        // Helper function to render mini slide for drag preview
        function renderMiniSlide(content) {
            const layout = content.layout || 'default';
            let miniBodyContent = '';

            switch (layout) {
                case 'cover':
                    miniBodyContent = `
                        <div style="display:flex;justify-content:center;gap:0.5rem;padding:0.25rem;">
                            ${content.coverStats.slice(0, 3).map(stat => `
                                <div style="text-align:center;">
                                    <div style="font-size:0.65rem;font-weight:700;color:var(--accent-color);">${stat.value}</div>
                                    <div style="font-size:0.5rem;color:#666;">${stat.label}</div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    break;
                case 'bar':
                    miniBodyContent = `
                        <div style="display:flex;align-items:flex-end;justify-content:space-around;height:50px;padding:0 0.25rem;">
                            ${content.barData.slice(0, 4).map(bar => `
                                <div style="width:15%;background:linear-gradient(180deg,var(--accent-gradient-start),var(--accent-gradient-end));height:${bar.value * 0.5}px;border-radius:2px 2px 0 0;"></div>
                            `).join('')}
                        </div>
                    `;
                    break;
                case 'timeline':
                    miniBodyContent = content.timelineItems.slice(0, 3).map(item => `
                        <div class="slide-mini-item"><i class="fas ${item.icon}"></i> ${item.text.slice(0, 25)}...</div>
                    `).join('');
                    break;
                case 'pie':
                    miniBodyContent = `
                        <div style="display:flex;align-items:center;justify-content:center;padding:0.25rem;">
                            <div style="width:45px;height:45px;border-radius:50%;background:conic-gradient(#38bdf8 0deg 126deg,#818cf8 126deg 216deg,#f472b6 216deg 288deg,#34d399 288deg 360deg);"></div>
                        </div>
                    `;
                    break;
                case 'metrics':
                    miniBodyContent = `
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:0.2rem;padding:0.2rem;">
                            ${content.metrics.slice(0, 4).map(m => `
                                <div style="background:white;border-radius:3px;padding:0.15rem;text-align:center;font-size:0.5rem;">
                                    <div style="font-weight:700;color:var(--accent-color);">${m.value}</div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    break;
                default:
                    if (content.items) {
                        miniBodyContent = content.items.slice(0, 3).map(item => `
                            <div class="slide-mini-item"><i class="fas ${item.icon}"></i> ${item.text}</div>
                        `).join('');
                    }
            }

            dragSlidePreview.innerHTML = `
                <div class="slide-mini-header">${content.title}</div>
                <div class="slide-mini-body">
                    ${miniBodyContent}
                </div>
            `;
        }

        function getCurrentSample() {
            return samples[currentSampleIndex];
        }

        function nextSample() {
            currentSampleIndex = (currentSampleIndex + 1) % samples.length;
        }

        function resetDemo() {
            currentPhase = 'idle';
            uploadZone.classList.remove('hidden', 'drag-over');
            uploadZone.classList.add('hidden');
            promptZone.classList.remove('visible');
            chatContainer.classList.remove('visible');
            chatMessages.innerHTML = '';
            processingOverlay.classList.remove('visible');
            resultArea.classList.remove('visible');
            dragFile.classList.remove('visible');
            endingScene.classList.remove('visible');
            progressFill.style.width = '0%';
            progressPercent.textContent = '0%';
            promptInput.value = '';
            promptInput.classList.remove('typing');
            generateBtn.classList.remove('ready', 'clicked');
        }

        function startDemoAnimation() {
            if (animationRunning) return;
            animationRunning = true;
            resetDemo();

            const sample = getCurrentSample();

            if (sample.type === 'upload') {
                // Deck translation flow (drag & drop)
                currentStatusMessages = translationStatusMessages;
                processingLabel.textContent = 'Translating deck...';
                uploadHeaderIcon.className = 'fas fa-language upload-header-icon';
                uploadTitle.textContent = 'Deck Translation';
                uploadText.textContent = 'Drag & drop your English deck here';
                uploadZone.classList.remove('hidden');

                // Setup slides for translation flow
                renderMiniSlide(sample.inputSlide);
                dragFileName.textContent = sample.fileName;
                renderSlide(processingSlide, sample.inputSlide, '');
                renderSlide(resultSlide, sample.resultSlide, 'chinese');

                setTimeout(simulateDragStart, 1000);
            } else if (sample.type === 'animate') {
                // Animate deck flow (drag & drop existing deck)
                currentStatusMessages = animatedStatusMessages;
                processingLabel.textContent = 'Adding animations...';
                uploadHeaderIcon.className = 'fas fa-wand-magic-sparkles upload-header-icon';
                uploadTitle.textContent = 'Animate Deck';
                uploadText.textContent = 'Drag & drop your deck to animate';
                uploadZone.classList.remove('hidden');

                // Setup slides for animate flow
                renderMiniSlide(sample.inputSlide);
                dragFileName.textContent = sample.fileName;
                renderSlide(processingSlide, sample.inputSlide, '');
                renderSlide(resultSlide, sample.resultSlide, 'animated');

                setTimeout(simulateDragStart, 1000);
            } else {
                // Prompt-based flow
                currentStatusMessages = promptStatusMessages;
                promptZoneTitle.textContent = 'Prompt to Deck';

                // Setup result slide for prompt flow
                renderSlide(resultSlide, sample.slideContent, '');

                setTimeout(showPromptZone, 500);
            }
        }

        // === PROMPT FLOW ===
        function showPromptZone() {
            currentPhase = 'prompt';
            promptZone.classList.add('visible');
            setTimeout(startTypingAnimation, 800);
        }

        function startTypingAnimation() {
            const sample = getCurrentSample();
            const text = sample.prompt;
            let charIndex = 0;

            promptInput.classList.add('typing');
            promptInput.value = '';

            const typingInterval = setInterval(() => {
                if (isPaused) return;

                if (charIndex < text.length) {
                    promptInput.value += text[charIndex];
                    charIndex++;
                } else {
                    clearInterval(typingInterval);
                    promptInput.classList.remove('typing');

                    setTimeout(() => {
                        generateBtn.classList.add('ready');
                        setTimeout(clickGenerateButton, 800);
                    }, 300);
                }
            }, 50);
        }

        function clickGenerateButton() {
            generateBtn.classList.add('clicked');

            setTimeout(() => {
                generateBtn.classList.remove('clicked');
                promptZone.classList.remove('visible');
                setTimeout(startChatFlow, 300);
            }, 200);
        }

        // === CHAT FLOW ===
        function startChatFlow() {
            currentPhase = 'chat';
            chatContainer.classList.add('visible');

            const sample = getCurrentSample();
            addChatBubble('user', sample.prompt);

            setTimeout(() => {
                addAIThinkingBubble();
                startChatProcessing();
            }, 800);
        }

        function addChatBubble(type, content) {
            const bubble = document.createElement('div');
            bubble.className = `chat-bubble ${type}`;

            if (type === 'user') {
                bubble.innerHTML = `
                    <div class="bubble-header">
                        <i class="fas fa-user"></i>
                        <span>You</span>
                    </div>
                    <div class="bubble-content">${content}</div>
                `;
            }

            chatMessages.appendChild(bubble);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return bubble;
        }

        function addAIThinkingBubble() {
            const bubble = document.createElement('div');
            bubble.className = 'chat-bubble ai';
            bubble.id = 'aiThinkingBubble';
            bubble.innerHTML = `
                <div class="bubble-header">
                    <i class="fas fa-robot"></i>
                    <span>AI Assistant</span>
                </div>
                <div class="bubble-content">
                    <div class="status-text" id="chatStatusText">
                        <i class="fas fa-spinner fa-spin"></i>
                        <span>${currentStatusMessages[0]}</span>
                    </div>
                </div>
            `;
            chatMessages.appendChild(bubble);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return bubble;
        }

        function startChatProcessing() {
            let statusIndex = 0;
            const statusText = document.getElementById('chatStatusText');

            const processingInterval = setInterval(() => {
                if (isPaused) return;

                statusIndex++;
                if (statusIndex < currentStatusMessages.length) {
                    statusText.innerHTML = `
                        <i class="fas fa-spinner fa-spin"></i>
                        <span>${currentStatusMessages[statusIndex]}</span>
                    `;
                } else {
                    clearInterval(processingInterval);
                    setTimeout(showChatResult, 500);
                }
            }, 800);
        }

        function showChatResult() {
            currentPhase = 'complete';
            const sample = getCurrentSample();

            const thinkingBubble = document.getElementById('aiThinkingBubble');
            if (thinkingBubble) {
                thinkingBubble.remove();
            }

            // Generate slide HTML for chat - now clickable with creative layouts
            const slideClass = sample.slideClass || '';
            const slideContent = sample.slideContent;
            const allSlides = sample.allSlides;
            const layout = slideContent.layout || 'default';
            const layoutClass = layout !== 'default' ? `layout-${layout}` : '';

            // Generate layout-specific body content for chat preview (compact version)
            let chatBodyContent = '';
            switch (layout) {
                case 'cover':
                    chatBodyContent = `
                        <div class="cover-stats" style="gap:1rem;margin-top:0.75rem;">
                            ${slideContent.coverStats.map(stat => `
                                <div class="cover-stat">
                                    <span class="cover-stat-value" style="font-size:1.2rem;">${stat.value}</span>
                                    <span class="cover-stat-label" style="font-size:0.6rem;">${stat.label}</span>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    break;
                case 'bar':
                    chatBodyContent = slideContent.barData.map(bar => `
                        <div class="bar-chart-item" style="max-width:60px;">
                            <div class="bar-wrapper" style="height:70px;">
                                <div class="bar" style="height:${bar.value * 0.7}px; --bar-height:${bar.value * 0.7}px;">
                                    <span class="bar-value" style="font-size:0.6rem;top:-18px;">${bar.displayValue}</span>
                                </div>
                            </div>
                            <span class="bar-label" style="font-size:0.55rem;">${bar.label}</span>
                        </div>
                    `).join('');
                    break;
                case 'timeline':
                    chatBodyContent = `
                        <div class="timeline-container" style="gap:0.4rem;padding-left:1.5rem;">
                            ${slideContent.timelineItems.slice(0, 3).map(item => `
                                <div class="timeline-item">
                                    <div class="timeline-node" style="width:14px;height:14px;left:-1.5rem;"><i class="fas ${item.icon}" style="font-size:0.45rem;"></i></div>
                                    <div class="timeline-content" style="padding:0.35rem 0.5rem;"><span style="font-size:0.65rem;">${item.text}</span></div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    break;
                case 'pie':
                    chatBodyContent = `
                        <div class="pie-chart-container" style="flex:0 0 80px;">
                            <div class="pie-chart" style="width:75px;height:75px;"></div>
                        </div>
                        <div class="pie-legend" style="gap:0.25rem;">
                            ${slideContent.pieData.map(item => `
                                <div class="pie-legend-item" style="padding:0.25rem 0.4rem;">
                                    <div class="pie-legend-color" style="width:10px;height:10px;" style="background:${item.color};"></div>
                                    <span class="pie-legend-text" style="font-size:0.6rem;">${item.label}</span>
                                    <span class="pie-legend-value" style="font-size:0.65rem;">${item.value}</span>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    break;
                case 'metrics':
                    chatBodyContent = slideContent.metrics.map(metric => `
                        <div class="metric-card" style="padding:0.5rem;">
                            <div class="metric-icon" style="width:24px;height:24px;font-size:0.7rem;margin-bottom:0.25rem;"><i class="fas ${metric.icon}"></i></div>
                            <span class="metric-value" style="font-size:0.85rem;">${metric.value}</span>
                            <span class="metric-label" style="font-size:0.55rem;">${metric.label}</span>
                        </div>
                    `).join('');
                    break;
                default:
                    if (slideContent.items) {
                        chatBodyContent = slideContent.items.map(item => `
                            <div class="slide-item" style="padding:0.4rem 0.6rem;">
                                <i class="fas ${item.icon}" style="font-size:0.85rem;"></i>
                                <span style="font-size:0.8rem;">${item.text}</span>
                            </div>
                        `).join('');
                    }
            }

            // For cover layout, put stats in header
            const headerExtra = layout === 'cover' ? chatBodyContent : '';
            const bodyContent = layout === 'cover' ? '' : chatBodyContent;

            const slideHTML = `
                <div class="slide-preview ${layoutClass} ${slideClass}" id="chatSlidePreview" style="width:100%;max-width:450px;aspect-ratio:16/9;">
                    <div class="slide-header" style="padding:1rem 1.25rem;">
                        <h2 style="font-size:1.1rem;margin-bottom:0.25rem;">${slideContent.title}</h2>
                        <p style="font-size:0.75rem;">${slideContent.subtitle}</p>
                        ${headerExtra}
                        ${slideClass === 'animated' ? '<div class="animation-badge"><i class="fas fa-play"></i> Animated</div>' : ''}
                    </div>
                    <div class="slide-body" style="padding:0.75rem 1rem;gap:0.5rem;">
                        ${bodyContent}
                    </div>
                    <div class="slide-footer" style="padding:0.5rem 1rem;font-size:0.7rem;">
                        <span>Slidemake AI</span>
                        <div class="slide-page"><i class="fas fa-clone"></i> 1 / 5</div>
                    </div>
                </div>
                <div class="click-hint">
                    <i class="fas fa-mouse-pointer"></i>
                    <span>Click to view all slides</span>
                </div>
            `;

            const resultBubble = document.createElement('div');
            resultBubble.className = 'chat-bubble ai';
            resultBubble.innerHTML = `
                <div class="bubble-header">
                    <i class="fas fa-robot"></i>
                    <span>AI Assistant</span>
                </div>
                <div class="bubble-content">
                    ${sample.resultText}
                    <div style="margin-top:0.75rem;">${slideHTML}</div>
                    <div class="result-label">
                        <i class="fas fa-check-circle"></i>
                        <span>${sample.badge}</span>
                    </div>
                </div>
            `;
            chatMessages.appendChild(resultBubble);
            chatMessages.scrollTop = chatMessages.scrollHeight;

            // Add click handler for slide preview
            const chatSlidePreview = document.getElementById('chatSlidePreview');
            if (chatSlidePreview) {
                chatSlidePreview.addEventListener('click', () => {
                    openSlideViewer(allSlides, 0, slideClass);
                });
            }

            // Auto-click after a short delay to show the slide viewer
            setTimeout(() => {
                if (isPaused) return;
                openSlideViewer(allSlides, 0, slideClass);
            }, 1500);
        }

        // === DRAG & DROP FLOW ===
        function simulateDragStart() {
            currentPhase = 'dragging';
            dragFile.classList.add('visible');

            const startX = 100;
            const startY = window.innerHeight - 250;
            const endX = window.innerWidth / 2 - 140;
            const endY = window.innerHeight / 2 - 110;

            dragFile.style.left = startX + 'px';
            dragFile.style.top = startY + 'px';

            let progress = 0;
            const dragDuration = 1500;
            const startTime = Date.now();

            function animateDrag() {
                const elapsed = Date.now() - startTime;
                progress = Math.min(elapsed / dragDuration, 1);

                const eased = 1 - Math.pow(1 - progress, 3);

                const currentX = startX + (endX - startX) * eased;
                const currentY = startY + (endY - startY) * eased;

                dragFile.style.left = currentX + 'px';
                dragFile.style.top = currentY + 'px';

                if (progress > 0.7) {
                    uploadZone.classList.add('drag-over');
                }

                if (progress < 1) {
                    requestAnimationFrame(animateDrag);
                } else {
                    setTimeout(simulateDrop, 200);
                }
            }

            requestAnimationFrame(animateDrag);
        }

        function simulateDrop() {
            dragFile.classList.remove('visible');
            uploadZone.classList.remove('drag-over');
            uploadZone.classList.add('hidden');

            setTimeout(startProcessing, 300);
        }

        function startProcessing() {
            currentPhase = 'processing';
            processingOverlay.classList.add('visible');

            let progress = 0;
            let statusIndex = 0;

            processingStatus.textContent = currentStatusMessages[0];

            const processingInterval = setInterval(() => {
                if (isPaused) return;

                const increment = Math.random() * 3 + 1;
                progress = Math.min(progress + increment, 100);

                progressFill.style.width = progress + '%';
                progressPercent.textContent = Math.round(progress) + '%';

                const newStatusIndex = Math.floor((progress / 100) * currentStatusMessages.length);
                if (newStatusIndex !== statusIndex && newStatusIndex < currentStatusMessages.length) {
                    statusIndex = newStatusIndex;
                    processingStatus.textContent = currentStatusMessages[statusIndex];
                }

                if (progress >= 100) {
                    clearInterval(processingInterval);
                    setTimeout(showResult, 500);
                }
            }, 100);
        }

        function showResult() {
            currentPhase = 'complete';
            processingOverlay.classList.remove('visible');

            const sample = getCurrentSample();
            resultBadgeText.textContent = sample.badge;

            setTimeout(() => {
                resultArea.classList.add('visible');

                // After showing result briefly, open slide viewer
                setTimeout(() => {
                    if (isPaused) return;
                    resultArea.classList.remove('visible');

                    // Determine slide class based on sample type
                    const slideClass = sample.type === 'animate' ? 'animated' : 'chinese';
                    openSlideViewer(sample.allResultSlides, 0, slideClass);
                }, 1500);
            }, 300);
        }

        function showEndingScene() {
            currentPhase = 'ending';
            endingScene.classList.add('visible');

            // Reset and play the ending video
            endingVideo.currentTime = 0;
            endingVideo.play();

            // When video ends, wait 4 more seconds then continue
            endingVideo.onended = () => {
                setTimeout(() => {
                    if (!isPaused) {
                        if (autoplay) {
                            // In autoplay mode, sequence complete
                            window.location.href = '../?sequence=complete';
                        } else {
                            // When visiting directly, hide ending and restart loop from first sample
                            endingScene.classList.remove('visible');
                            currentSampleIndex = 0;
                            setTimeout(startDemoAnimation, 500);
                        }
                    }
                }, 4000); // 4 second hold after video ends
            };
        }

        // Fullscreen
        fullscreenBtn.addEventListener('click', () => {
            toggleFullscreen();
        });

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
                document.body.classList.add('fullscreen');
                fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
                fullscreenBtn.title = 'Exit Fullscreen';
            } else {
                document.exitFullscreen();
                document.body.classList.remove('fullscreen');
                fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
                fullscreenBtn.title = 'Fullscreen';
            }
        }

        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement) {
                document.body.classList.remove('fullscreen');
                fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
                fullscreenBtn.title = 'Fullscreen';
            }
        });

        // Play/Pause
        function updatePlayPauseButton() {
            if (isPaused) {
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                playPauseBtn.title = 'Play';
                playPauseBtn.classList.remove('active');
            } else {
                playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                playPauseBtn.title = 'Pause';
                playPauseBtn.classList.add('active');
            }
        }

        playPauseBtn.addEventListener('click', () => {
            isPaused = !isPaused;
            updatePlayPauseButton();

            if (!isPaused && !animationRunning) {
                startDemoAnimation();
            }
        });

        // Auto-start
        window.addEventListener('load', () => {
            if (document.fullscreenElement) {
                document.body.classList.add('fullscreen');
                fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
                fullscreenBtn.title = 'Exit Fullscreen';
            }

            if (autoplay) {
                setTimeout(startDemoAnimation, 500);
            } else {
                setTimeout(startDemoAnimation, 1500);
            }
        });

        // === SLIDE VIEWER ===
        const slideViewerOverlay = document.getElementById('slideViewerOverlay');
        const slideViewerTitle = document.getElementById('slideViewerTitle');
        const slideViewerSlide = document.getElementById('slideViewerSlide');
        const slideViewerClose = document.getElementById('slideViewerClose');
        const slidePrevBtn = document.getElementById('slidePrevBtn');
        const slideNextBtn = document.getElementById('slideNextBtn');
        const slideDots = document.getElementById('slideDots');

        let viewerSlides = [];
        let viewerCurrentIndex = 0;
        let viewerSlideClass = '';
        let viewerAutoAdvance = null;

        function openSlideViewer(slides, startIndex = 0, slideClass = '') {
            viewerSlides = slides;
            viewerCurrentIndex = startIndex;
            viewerSlideClass = slideClass;

            // Pause the main demo
            isPaused = true;
            updatePlayPauseButton();

            // Create dots
            slideDots.innerHTML = slides.map((_, i) =>
                `<div class="slide-dot ${i === startIndex ? 'active' : ''}" data-index="${i}"></div>`
            ).join('');

            // Add click handlers to dots
            slideDots.querySelectorAll('.slide-dot').forEach(dot => {
                dot.addEventListener('click', () => {
                    goToSlide(parseInt(dot.dataset.index));
                });
            });

            slideViewerTitle.textContent = `${deckTheme.title} - ${slides.length} Slides`;
            renderViewerSlide();
            slideViewerOverlay.classList.add('visible');

            // Auto advance slides
            startAutoAdvance();
        }

        function closeSlideViewer() {
            slideViewerOverlay.classList.remove('visible');
            stopAutoAdvance();

            // Continue the demo - move to next sample or ending
            setTimeout(() => {
                chatContainer.classList.remove('visible');
                animationRunning = false;
                isPaused = false;
                updatePlayPauseButton();

                if (currentSampleIndex === samples.length - 1) {
                    loopCount++;
                    showEndingScene();
                    return;
                }

                nextSample();
                setTimeout(startDemoAnimation, 500);
            }, 300);
        }

        function renderViewerSlide() {
            const slide = viewerSlides[viewerCurrentIndex];
            const layout = slide.layout || 'default';
            const isAnimated = viewerSlideClass.includes('animated');
            const layoutClass = layout !== 'default' ? `layout-${layout}` : '';
            slideViewerSlide.className = `slide-preview ${layoutClass} ${viewerSlideClass}`.trim();

            let bodyContent = '';
            let headerExtra = isAnimated ? '<div class="animation-badge"><i class="fas fa-play"></i> Animated</div>' : '';

            switch (layout) {
                case 'cover':
                    bodyContent = `
                        <div class="cover-stats">
                            ${slide.coverStats.map(stat => `
                                <div class="cover-stat">
                                    <span class="cover-stat-value">${stat.value}</span>
                                    <span class="cover-stat-label">${stat.label}</span>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    slideViewerSlide.innerHTML = `
                        <div class="slide-header">
                            <h2>${slide.title}</h2>
                            <p>${slide.subtitle}</p>
                            ${bodyContent}
                            ${headerExtra}
                        </div>
                        <div class="slide-body"></div>
                        <div class="slide-footer">
                            <span>Slidemake AI</span>
                            <div class="slide-page"><i class="fas fa-clone"></i> ${viewerCurrentIndex + 1} / ${viewerSlides.length}</div>
                        </div>
                    `;
                    break;

                case 'bar':
                    bodyContent = slide.barData.map(bar => `
                        <div class="bar-chart-item">
                            <div class="bar-wrapper">
                                <div class="bar" style="height: ${bar.value}px; --bar-height: ${bar.value}px;">
                                    <span class="bar-value">${bar.displayValue}</span>
                                </div>
                            </div>
                            <span class="bar-label">${bar.label}</span>
                        </div>
                    `).join('');
                    slideViewerSlide.innerHTML = `
                        <div class="slide-header">
                            <h2>${slide.title}</h2>
                            <p>${slide.subtitle}</p>
                            ${headerExtra}
                        </div>
                        <div class="slide-body">${bodyContent}</div>
                        <div class="slide-footer">
                            <span>Slidemake AI</span>
                            <div class="slide-page"><i class="fas fa-clone"></i> ${viewerCurrentIndex + 1} / ${viewerSlides.length}</div>
                        </div>
                    `;
                    break;

                case 'timeline':
                    bodyContent = `
                        <div class="timeline-container">
                            ${slide.timelineItems.map(item => `
                                <div class="timeline-item">
                                    <div class="timeline-node"><i class="fas ${item.icon}"></i></div>
                                    <div class="timeline-content"><span>${item.text}</span></div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    slideViewerSlide.innerHTML = `
                        <div class="slide-header">
                            <h2>${slide.title}</h2>
                            <p>${slide.subtitle}</p>
                            ${headerExtra}
                        </div>
                        <div class="slide-body">${bodyContent}</div>
                        <div class="slide-footer">
                            <span>Slidemake AI</span>
                            <div class="slide-page"><i class="fas fa-clone"></i> ${viewerCurrentIndex + 1} / ${viewerSlides.length}</div>
                        </div>
                    `;
                    break;

                case 'pie':
                    bodyContent = `
                        <div class="pie-chart-container">
                            <div class="pie-chart"></div>
                        </div>
                        <div class="pie-legend">
                            ${slide.pieData.map(item => `
                                <div class="pie-legend-item">
                                    <div class="pie-legend-color" style="background: ${item.color};"></div>
                                    <span class="pie-legend-text">${item.label}</span>
                                    <span class="pie-legend-value">${item.value}</span>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    slideViewerSlide.innerHTML = `
                        <div class="slide-header">
                            <h2>${slide.title}</h2>
                            <p>${slide.subtitle}</p>
                            ${headerExtra}
                        </div>
                        <div class="slide-body">${bodyContent}</div>
                        <div class="slide-footer">
                            <span>Slidemake AI</span>
                            <div class="slide-page"><i class="fas fa-clone"></i> ${viewerCurrentIndex + 1} / ${viewerSlides.length}</div>
                        </div>
                    `;
                    break;

                case 'metrics':
                    bodyContent = slide.metrics.map(metric => `
                        <div class="metric-card">
                            <div class="metric-icon"><i class="fas ${metric.icon}"></i></div>
                            <span class="metric-value">${metric.value}</span>
                            <span class="metric-label">${metric.label}</span>
                        </div>
                    `).join('');
                    slideViewerSlide.innerHTML = `
                        <div class="slide-header">
                            <h2>${slide.title}</h2>
                            <p>${slide.subtitle}</p>
                            ${headerExtra}
                        </div>
                        <div class="slide-body">${bodyContent}</div>
                        <div class="slide-footer">
                            <span>Slidemake AI</span>
                            <div class="slide-page"><i class="fas fa-clone"></i> ${viewerCurrentIndex + 1} / ${viewerSlides.length}</div>
                        </div>
                    `;
                    break;

                default:
                    // Fallback for items-based slides
                    bodyContent = slide.items ? slide.items.map(item => `
                        <div class="slide-item">
                            <i class="fas ${item.icon}"></i>
                            <span>${item.text}</span>
                        </div>
                    `).join('') : '';
                    slideViewerSlide.innerHTML = `
                        <div class="slide-header">
                            <h2>${slide.title}</h2>
                            <p>${slide.subtitle}</p>
                            ${headerExtra}
                        </div>
                        <div class="slide-body">${bodyContent}</div>
                        <div class="slide-footer">
                            <span>Slidemake AI</span>
                            <div class="slide-page"><i class="fas fa-clone"></i> ${viewerCurrentIndex + 1} / ${viewerSlides.length}</div>
                        </div>
                    `;
            }

            // Update dots
            slideDots.querySelectorAll('.slide-dot').forEach((dot, i) => {
                dot.classList.toggle('active', i === viewerCurrentIndex);
            });

            // Update nav buttons
            slidePrevBtn.disabled = viewerCurrentIndex === 0;
            slideNextBtn.disabled = viewerCurrentIndex === viewerSlides.length - 1;
        }

        function goToSlide(index) {
            if (index >= 0 && index < viewerSlides.length) {
                viewerCurrentIndex = index;
                renderViewerSlide();
                restartAutoAdvance();
            }
        }

        function nextSlide() {
            if (viewerCurrentIndex < viewerSlides.length - 1) {
                viewerCurrentIndex++;
                renderViewerSlide();
            } else {
                // Close viewer when reaching the end
                closeSlideViewer();
            }
        }

        function prevSlide() {
            if (viewerCurrentIndex > 0) {
                viewerCurrentIndex--;
                renderViewerSlide();
            }
        }

        function startAutoAdvance() {
            stopAutoAdvance();
            viewerAutoAdvance = setInterval(() => {
                if (viewerCurrentIndex < viewerSlides.length - 1) {
                    nextSlide();
                } else {
                    closeSlideViewer();
                }
            }, 3000);
        }

        function stopAutoAdvance() {
            if (viewerAutoAdvance) {
                clearInterval(viewerAutoAdvance);
                viewerAutoAdvance = null;
            }
        }

        function restartAutoAdvance() {
            startAutoAdvance();
        }

        // Event listeners
        slideViewerClose.addEventListener('click', closeSlideViewer);
        slidePrevBtn.addEventListener('click', () => { prevSlide(); restartAutoAdvance(); });
        slideNextBtn.addEventListener('click', () => { nextSlide(); restartAutoAdvance(); });

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (!slideViewerOverlay.classList.contains('visible')) return;

            if (e.key === 'ArrowRight' || e.key === ' ') {
                nextSlide();
                restartAutoAdvance();
            } else if (e.key === 'ArrowLeft') {
                prevSlide();
                restartAutoAdvance();
            } else if (e.key === 'Escape') {
                closeSlideViewer();
            }
        });

        // Close on backdrop click
        slideViewerOverlay.addEventListener('click', (e) => {
            if (e.target === slideViewerOverlay) {
                closeSlideViewer();
            }
        });
    </script>
</body>
</html>
